{
  "global_enable": {
    "description": "全局开关（黑名单模式）",
    "type": "bool",
    "hint": "true=默认启用，使用 disabled_umos 拉黑；false=默认关闭，使用 enabled_umos 放行",
    "default": true
  },
  "enabled_umos": {
    "description": "白名单 UMO 列表（仅在全局关闭时生效）",
    "type": "list",
    "items": { "type": "string" },
    "hint": "UMO 格式为 platform:message_type:session_id，可通过 /sid 命令获取",
    "default": []
  },
  "disabled_umos": {
    "description": "黑名单 UMO 列表（仅在全局开启时生效）",
    "type": "list",
    "items": { "type": "string" },
    "hint": "UMO 格式为 platform:message_type:session_id，可通过 /sid 命令获取",
    "default": []
  },
  "text_voice_umos": {
    "description": "文字+语音同显 UMO 列表",
    "type": "list",
    "items": { "type": "string" },
    "hint": "对于这些会话，先发文字消息再发语音。UMO 可通过 /sid 命令获取",
    "default": []
  },
  "prob": {
    "description": "触发概率",
    "type": "float",
    "hint": "0~1 之间",
    "default": 1.0
  },
  "text_limit": {
    "description": "最大文本长度",
    "type": "int",
    "hint": "超过将不触发TTS",
    "default": 200
  },
  "cooldown": {
    "description": "冷却时间（秒）",
    "type": "int",
    "hint": "两次触发最短间隔",
    "default": 0
  },
  "allow_mixed": {
    "description": "允许混合内容（非纯文本消息也尝试TTS）",
    "type": "bool",
    "default": false
  },
  "show_references": {
    "description": "是否显示参考文献（当文本包含代码或链接时）",
    "type": "bool",
    "default": true,
    "hint": "开启后会在TTS音频后附加提取的代码和链接的参考文献"
  },
  "api": {
    "description": "硅基流动 API 设置",
    "type": "object",
    "items": {
      "url": { "description": "API Base", "type": "string", "default": "https://api.siliconflow.cn/v1" },
      "key": { "description": "API Key", "type": "string", "default": "" },
      "model": { "description": "模型名称", "type": "string", "default": "FunAudioLLM/CosyVoice2-0.5B" },
      "format": { "description": "音频格式(mp3/wav/opus/pcm)", "type": "string", "default": "mp3" },
      "speed": { "description": "默认语速", "type": "float", "default": 1.0 },
      "gain": { "description": "音量增益（dB，-10~10），调低可有效减少电流音", "type": "float", "default": 0 },
      "sample_rate": { "description": "采样率(mp3/wav推荐44100，opus固定48000)", "type": "int", "default": 44100 }
    }
  },
  "emotion": {
    "description": "情绪策略（隐藏标记 + 启发式）",
    "type": "object",
    "items": {
      "marker": {
        "description": "隐藏情绪标记（不对用户可见）",
        "type": "object",
        "items": {
          "enable": { "description": "启用隐藏标记解析", "type": "bool", "default": true },
          "tag": { "description": "标记名（如 EMO，对应 [EMO:happy]）", "type": "string", "default": "EMO" },
          "prompt_hint": {
            "description": "系统会自动在请求前注入 ‘请先输出隐藏情绪标记 [EMO:happy|sad|angry|neutral] 再答复’ 的提示。",
            "type": "string",
            "default": "请在每次回复开头先输出隐藏情绪标记 [EMO:happy|sad|angry|neutral]，该标记仅供系统解析，不会展示给用户。"
          }
        }
      }
    }
  },
  "voice_map": {
    "description": "情绪到音色映射",
    "type": "object",
    "items": {
      "neutral": { "description": "中性音色", "type": "string", "default": "" },
      "happy": { "description": "高兴音色", "type": "string", "default": "" },
      "sad": { "description": "伤心音色", "type": "string", "default": "" },
      "angry": { "description": "愤怒音色", "type": "string", "default": "" }
    }
  },
  "speed_map": {
    "description": "情绪到语速倍率映射（留空使用默认语速）",
    "type": "object",
    "items": {
      "neutral": { "description": "中性语速(1.0=默认)", "type": "float", "default": 1.0 },
      "happy": { "description": "高兴语速", "type": "float", "default": 1.2 },
      "sad": { "description": "伤心语速", "type": "float", "default": 0.85 },
      "angry": { "description": "愤怒语速", "type": "float", "default": 1.1 }
    }
  },
  "references": {
    "description": "参考文献显示策略",
    "type": "object",
    "items": {
      "preview_limit": { "description": "单段代码最大展示字符(0=不截断)", "type": "int", "default": 0 },
      "max_total_chars": { "description": "参考文献总字符上限(0=不限制)", "type": "int", "default": 0 }
    }
  }
}
